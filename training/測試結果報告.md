# PlantVillage 植物病害檢測模型測試結果報告

## 模型概述

本模型使用 **EfficientNetB3** 預訓練模型結合遷移學習技術，針對 PlantVillage 資料集進行植物病害分類任務。

### 方法特點

結合四種最佳實踐方法：

1. **EfficientNetB3 預訓練模型**：高效的深度學習架構
2. **完整的資料處理流程**：使用 DataFrame 方式進行資料管理
3. **自定義 Callback 系統**：動態學習率調整和早停機制
4. **完整的資料增強策略**：提升模型泛化能力
5. **GPU 加速訓練**：使用 TensorFlow 2.10.0

---

## 模型架構

### 基本資訊

- **基礎模型**：EfficientNetB3（ImageNet 預訓練）
- **輸入尺寸**：224 × 224 × 3
- **輸出類別數**：38
- **總參數**：11,192,917
- **可訓練參數**：11,102,542
- **不可訓練參數**：90,375

### 模型結構

```
Sequential Model
├── EfficientNetB3 (預訓練)
│   └── 輸出：1536 維特徵向量
├── BatchNormalization
├── Dense(256, activation='relu')
│   ├── kernel_regularizer: L2(0.016)
│   ├── activity_regularizer: L1(0.006)
│   └── bias_regularizer: L1(0.006)
├── Dropout(0.45)
└── Dense(38, activation='softmax')
```

### 編譯配置

- **優化器**：Adamax
- **初始學習率**：0.001
- **損失函數**：categorical_crossentropy（分類交叉熵）
- **評估指標**：accuracy（準確率）

### 評分標準與評估指標

模型訓練和評估使用以下指標：

#### 1. 訓練過程指標

**損失函數（Loss）**：

- **categorical_crossentropy（分類交叉熵）**：用於多類別分類任務的標準損失函數
- 衡量預測機率分布與真實標籤分布的差異
- 數值越小越好，理想值接近 0

**評估指標（Metrics）**：

- **Accuracy（準確率）**：正確預測的樣本數佔總樣本數的比例
- 公式：Accuracy = (TP + TN) / (TP + TN + FP + FN)
- 範圍：0 到 1，數值越大越好，1 表示完美分類

**訓練過程監控**：

- 訓練損失（Training Loss）
- 訓練準確率（Training Accuracy）
- 驗證損失（Validation Loss）
- 驗證準確率（Validation Accuracy）

#### 2. 最終評估指標

使用 sklearn 的 `classification_report` 進行詳細評估，包含：

**Precision（精確率）**：

- 在所有預測為該類別的樣本中，實際確實屬於該類別的比例
- 公式：Precision = TP / (TP + FP)
- 衡量模型預測的可靠性

**Recall（召回率）**：

- 在所有實際屬於該類別的樣本中，被正確識別的比例
- 公式：Recall = TP / (TP + FN)
- 衡量模型的覆蓋率

**F1-Score（F1 分數）**：

- Precision 和 Recall 的調和平均數
- 公式：F1 = 2 × (Precision × Recall) / (Precision + Recall)
- 綜合評估模型性能的指標，範圍 0 到 1

**整體準確率（Overall Accuracy）**：

- 所有類別的整體分類準確率

#### 3. 模型選擇標準

**自定義 Callback 監控策略**：

- 訓練準確率 < 90% 時：監控訓練準確率的改善
- 訓練準確率 ≥ 90% 時：監控驗證損失的改善
- 使用驗證損失作為主要優化目標，因為更能反映模型泛化能力

**最佳模型選擇**：

- 根據驗證損失或驗證準確率選擇最佳 epoch 的模型權重
- 確保選擇的模型在驗證集上表現最佳

---

## 資料集資訊

### 資料集整體概覽

![資料集資訊摘要](img/dataset_summary.png)

### 資料分割

![資料集分割](img/dataset_split.png)

**詳細數據**：

| 資料集   | 樣本數     | 比例     |
| -------- | ---------- | -------- |
| 訓練集   | 43,444     | 80%      |
| 驗證集   | 5,430      | 10%      |
| 測試集   | 5,431      | 10%      |
| **總計** | **54,305** | **100%** |

### 類別統計

![類別統計](img/class_statistics.png)

### 類別數量

- **總類別數**：38 種植物病害類型
- **涵蓋植物種類**：14 種主要植物
- **健康類別數**：14 個
- **病害類別數**：24 個

### 完整植物類型列表

#### 按植物分類的完整類別

**1. 蘋果 (Apple) - 4 類**

- Apple\_\_\_Apple_scab（蘋果黑星病）
- Apple\_\_\_Black_rot（蘋果黑腐病）
- Apple\_\_\_Cedar_apple_rust（蘋果雪松鏽病）
- Apple\_\_\_healthy（健康蘋果）

**2. 藍莓 (Blueberry) - 1 類**

- Blueberry\_\_\_healthy（健康藍莓）

**3. 櫻桃 (Cherry) - 2 類**

- Cherry\_(including_sour)\_\_\_Powdery_mildew（櫻桃白粉病）
- Cherry\_(including_sour)\_\_\_healthy（健康櫻桃）

**4. 玉米 (Corn/Maize) - 4 類**

- Corn\_(maize)\_\_\_Cercospora_leaf_spot Gray_leaf_spot（玉米尾孢菌葉斑病/灰斑病）
- Corn\_(maize)_\_\_Common_rust_（玉米普通鏽病）
- Corn\_(maize)\_\_\_Northern_Leaf_Blight（玉米北方葉枯病）
- Corn\_(maize)\_\_\_healthy（健康玉米）

**5. 葡萄 (Grape) - 4 類**

- Grape\_\_\_Black_rot（葡萄黑腐病）
- Grape*\_\_Esca*(Black_Measles)（葡萄黑麻疹病）
- Grape*\_\_Leaf_blight*(Isariopsis_Leaf_Spot)（葡萄葉枯病/等軸孢葉斑病）
- Grape\_\_\_healthy（健康葡萄）

**6. 柑橘 (Orange) - 1 類**

- Orange*\_\_Haunglongbing*(Citrus_greening)（柑橘黃龍病/柑橘綠化病）

**7. 桃子 (Peach) - 2 類**

- Peach\_\_\_Bacterial_spot（桃子細菌性斑點病）
- Peach\_\_\_healthy（健康桃子）

**8. 甜椒 (Pepper, bell) - 2 類**

- Pepper,\_bell\_\_\_Bacterial_spot（甜椒細菌性斑點病）
- Pepper,\_bell\_\_\_healthy（健康甜椒）

**9. 馬鈴薯 (Potato) - 3 類**

- Potato\_\_\_Early_blight（馬鈴薯早疫病）
- Potato\_\_\_Late_blight（馬鈴薯晚疫病）
- Potato\_\_\_healthy（健康馬鈴薯）

**10. 覆盆子 (Raspberry) - 1 類**

- Raspberry\_\_\_healthy（健康覆盆子）

**11. 大豆 (Soybean) - 1 類**

- Soybean\_\_\_healthy（健康大豆）

**12. 南瓜 (Squash) - 1 類**

- Squash\_\_\_Powdery_mildew（南瓜白粉病）

**13. 草莓 (Strawberry) - 2 類**

- Strawberry\_\_\_Leaf_scorch（草莓葉焦病）
- Strawberry\_\_\_healthy（健康草莓）

**14. 番茄 (Tomato) - 10 類**

- Tomato\_\_\_Bacterial_spot（番茄細菌性斑點病）
- Tomato\_\_\_Early_blight（番茄早疫病）
- Tomato\_\_\_Late_blight（番茄晚疫病）
- Tomato\_\_\_Leaf_Mold（番茄葉黴病）
- Tomato\_\_\_Septoria_leaf_spot（番茄斑枯病）
- Tomato\_\_\_Spider_mites Two-spotted_spider_mite（番茄二斑葉蟎）
- Tomato\_\_\_Target_Spot（番茄靶斑病）
- Tomato\_\_\_Tomato_Yellow_Leaf_Curl_Virus（番茄黃化曲葉病毒）
- Tomato\_\_\_Tomato_mosaic_virus（番茄花葉病毒）
- Tomato\_\_\_healthy（健康番茄）

#### 植物種類統計

| 植物種類 | 類別數 | 健康類別 | 病害類別 |
| -------- | ------ | -------- | -------- |
| 蘋果     | 4      | 1        | 3        |
| 藍莓     | 1      | 1        | 0        |
| 櫻桃     | 2      | 1        | 1        |
| 玉米     | 4      | 1        | 3        |
| 葡萄     | 4      | 1        | 3        |
| 柑橘     | 1      | 0        | 1        |
| 桃子     | 2      | 1        | 1        |
| 甜椒     | 2      | 1        | 1        |
| 馬鈴薯   | 3      | 1        | 2        |
| 覆盆子   | 1      | 1        | 0        |
| 大豆     | 1      | 1        | 0        |
| 南瓜     | 1      | 0        | 1        |
| 草莓     | 2      | 1        | 1        |
| 番茄     | 10     | 1        | 9        |
| **總計** | **38** | **14**   | **24**   |

#### 病害類型分類

**真菌性病害**：黑星病、白粉病、鏽病、葉斑病、葉枯病、葉黴病、早疫病、晚疫病、斑枯病、靶斑病

**細菌性病害**：細菌性斑點病、黑腐病

**病毒性病害**：黃化曲葉病毒、花葉病毒

**其他**：黃龍病/綠化病、葉焦病、二斑葉蟎、黑麻疹病、等軸孢葉斑病

### 測試集樣本分布

![測試集樣本分布](img/test_samples_distribution.png)

**說明**：上圖展示測試集中樣本數最多的前 15 個類別。可以看到：

- 樣本數最多的類別是 Orange_Haunglongbing（551 樣本）和 Tomato_Yellow_Leaf_Curl_Virus（536 樣本）
- 大部分類別的樣本數在 100-200 之間
- 樣本分布相對均衡，有助於模型學習各類別特徵

---

## 訓練配置

### 超參數設定

| 參數                   | 數值  |
| ---------------------- | ----- |
| Epochs                 | 40    |
| Batch Size             | 32    |
| 每 Epoch 批次數        | 1,358 |
| 學習率衰減因子         | 0.5   |
| Patience（學習率調整） | 1     |
| Stop Patience          | 3     |
| 訓練準確率閾值         | 0.9   |

### 資料增強策略

**訓練階段**：

- 旋轉範圍：20 度
- 寬度/高度平移：0.2
- 剪切變換：0.2
- 縮放範圍：0.2
- 水平翻轉：是
- 填充模式：nearest
- 正規化：除以 255

**驗證/測試階段**：

- 僅進行正規化（除以 255）

**圖片尺寸處理**：

- **原始圖片尺寸**：256 × 256 像素（PlantVillage 資料集原始尺寸）
- **模型輸入尺寸**：224 × 224 像素
- **處理方式**：使用 `target_size=(224, 224)` 參數進行**縮放（resize）**，而非裁剪（crop）
- **技術細節**：ImageDataGenerator 會自動將原始圖片從 256×256 縮放到 224×224，使用雙線性插值等算法保持圖片品質

---

## 訓練結果

### 訓練歷程摘要

訓練過程共進行 **20 個 Epoch**，使用自定義 Callback 進行學習率動態調整。

**關鍵 Epoch 表現**：

| Epoch | 訓練損失 | 訓練準確率 | 驗證損失 | 驗證準確率 | 學習率  |
| ----- | -------- | ---------- | -------- | ---------- | ------- |
| 1     | 2.878    | 90.21%     | 428.41   | 7.29%      | 0.00100 |
| 5     | 0.253    | 99.44%     | 0.600    | 90.26%     | 0.00050 |
| 10    | 0.173    | 99.78%     | 0.182    | 98.97%     | 0.00025 |
| 15    | 0.148    | 99.90%     | 0.135    | 99.80%     | 0.00006 |
| 20    | 0.140    | 99.92%     | 0.127    | 99.87%     | 0.00003 |

**訓練時間**：4 小時 37 分 40.98 秒

### 最終評估結果

#### 整體性能指標

| 資料集     | 損失   | 準確率     |
| ---------- | ------ | ---------- |
| **訓練集** | 0.1172 | **99.99%** |
| **驗證集** | 0.1213 | **99.91%** |
| **測試集** | 0.1194 | **99.87%** |

#### 詳細分析

- **訓練準確率**：99.99%，顯示模型能很好地學習訓練資料的特徵
- **驗證準確率**：99.91%，顯示模型具有良好的泛化能力
- **測試準確率**：99.87%，證明模型在未見資料上表現優秀
- **過擬合程度**：極低（訓練與測試準確率差距僅 0.12%）

---

## 分類報告

### 整體統計

| 指標           | 精確率 | 召回率 | F1 分數 | 樣本數   |
| -------------- | ------ | ------ | ------- | -------- |
| **整體準確率** | -      | -      | -       | **5431** |
| **宏觀平均**   | 1.00   | 1.00   | 1.00    | 5431     |
| **加權平均**   | 1.00   | 1.00   | 1.00    | 5431     |

### 各類別詳細表現

#### 完美分類類別（Precision=Recall=F1=1.00）

以下 31 個類別達到完美分類效果（Precision、Recall、F1-Score 均為 1.00）：

1. Apple\_\_\_Apple_scab (63 樣本)
2. Apple\_\_\_Black_rot (62 樣本)
3. Apple\_\_\_Cedar_apple_rust (27 樣本)
4. Apple\_\_\_healthy (165 樣本)
5. Blueberry\_\_\_healthy (150 樣本)
6. Cherry\_(including_sour)\_\_\_Powdery_mildew (105 樣本)
7. Cherry\_(including_sour)\_\_\_healthy (85 樣本)
8. Corn\_(maize)_\_\_Common_rust_ (119 樣本)
9. Corn\_(maize)\_\_\_healthy (116 樣本)
10. Grape\_\_\_Black_rot (118 樣本)
11. Grape*\_\_Esca*(Black_Measles) (139 樣本)
12. Grape*\_\_Leaf_blight*(Isariopsis_Leaf_Spot) (108 樣本)
13. Grape\_\_\_healthy (42 樣本)
14. Orange*\_\_Haunglongbing*(Citrus_greening) (551 樣本)
15. Peach\_\_\_Bacterial_spot (230 樣本)
16. Peach\_\_\_healthy (36 樣本)
17. Pepper,\_bell\_\_\_Bacterial_spot (100 樣本)
18. Pepper,\_bell\_\_\_healthy (148 樣本)
19. Potato\_\_\_Early_blight (100 樣本)
20. Potato\_\_\_Late_blight (100 樣本)
21. Potato\_\_\_healthy (15 樣本)
22. Raspberry\_\_\_healthy (37 樣本)
23. Soybean\_\_\_healthy (509 樣本)
24. Squash\_\_\_Powdery_mildew (184 樣本)
25. Strawberry\_\_\_Leaf_scorch (111 樣本)
26. Strawberry\_\_\_healthy (45 樣本)
27. Tomato\_\_\_Bacterial_spot (213 樣本)
28. Tomato\_\_\_Leaf_Mold (95 樣本)
29. Tomato\_\_\_Tomato_Yellow_Leaf_Curl_Virus (536 樣本)
30. Tomato\_\_\_Tomato_mosaic_virus (37 樣本)
31. Tomato\_\_\_healthy (159 樣本)

#### 接近完美分類類別（F1 ≥ 0.96）

以下 7 個類別表現優秀，但存在極少量誤分類：

| 類別                                                   | Precision | Recall | F1-Score | Support |
| ------------------------------------------------------ | --------- | ------ | -------- | ------- |
| Corn\_(maize)\_\_\_Cercospora_leaf_spot Gray_leaf_spot | 0.98      | 0.94   | 0.96     | 51      |
| Corn\_(maize)\_\_\_Northern_Leaf_Blight                | 0.97      | 0.99   | 0.98     | 98      |
| Tomato\_\_\_Early_blight                               | 1.00      | 0.99   | 0.99     | 100     |
| Tomato\_\_\_Late_blight                                | 0.99      | 1.00   | 1.00     | 191     |
| Tomato\_\_\_Septoria_leaf_spot                         | 0.99      | 1.00   | 1.00     | 177     |
| Tomato\_\_\_Spider_mites Two-spotted_spider_mite       | 0.99      | 1.00   | 1.00     | 168     |
| Tomato\_\_\_Target_Spot                                | 1.00      | 0.99   | 0.99     | 141     |

**說明**：雖然 Tomato\_\_\_Late_blight、Tomato\_\_\_Septoria_leaf_spot 和 Tomato\_\_\_Spider_mites 的 F1-Score 為 1.00，但其 Precision 為 0.99（表示有極少數誤分類），因此歸類為接近完美分類。

**統計總結**：

- **完美分類類別**：31 個（Precision=Recall=F1=1.00）
- **接近完美分類類別**：7 個（F1 ≥ 0.96，其中 3 個 F1=1.00 但 Precision/Recall 不是全部為 1.00）
- **總計**：38 個類別中，38 個都達到優秀表現（F1 ≥ 0.96）

---

## 視覺化分析

### 1. 所有類別植物圖片完整展示

以下是資料集中所有 38 個類別的實際植物圖像樣本：

![所有類別圖片展示](img/all_categories_grid.png)

**圖片說明**：

- 展示所有 38 個植物病害類別的圖像樣本
- 每個類別選取 1 張代表性圖像
- 展示圖片已調整為統一尺寸（200×200 像素）以便於網格展示（模型訓練時使用的輸入尺寸為 224×224 像素）
- **綠色標籤**：健康植物類別（共 14 個）
- **紅色標籤**：病害植物類別（共 24 個）
- 類別名稱標註在每張圖像上方

**觀察結果**：

- 資料集樣本品質良好，圖像清晰度高
- 不同類別之間視覺特徵差異明顯，便於模型學習和區分
- 健康植物與病害植物在外觀上有明顯差異：
  - **健康植物**：葉片完整、顏色鮮綠、無明顯病變
  - **病害植物**：呈現各種異常特徵（斑點、變色、形態變化等）
- 不同病害類型具有獨特的視覺特徵：
  - **真菌性病害**：如鏽病、白粉病、葉斑病等，呈現特定的顏色和圖案
  - **細菌性病害**：如細菌性斑點病，通常呈現小斑點狀
  - **病毒性病害**：如花葉病毒，呈現不規則的變色圖案
  - **其他**：如葉蟎損害、葉焦病、黃龍病等

### 1.1 部分類別樣本展示

以下展示部分代表性類別的樣本（便於詳細查看）：

![植物病害樣本展示](img/sample_images_grid.png)

**說明**：展示 12 個不同類別的植物圖像樣本，每個類別選取 1 張代表性圖像。

### 2. 健康與病害植物對比展示

為了更直觀地展示健康植物與病害植物的差異，以下是幾種代表性植物的對比：

![健康與病害植物對比](img/category_comparison.png)

**對比說明**：

- **綠色標籤**：健康植物
- **紅色標籤**：病害植物
- 展示蘋果、番茄、玉米三種作物的健康狀態與病害狀態對比
- 可以清楚看到病害植物葉片上的異常特徵（斑點、變色、形態變化等）

**視覺特徵差異**：

1. **健康植物**：葉片完整、顏色鮮綠、無明顯病變痕跡
2. **病害植物**：
   - 蘋果黑星病：葉片出現深色斑點和病變
   - 番茄細菌性斑點病：葉片上散布褐色小斑點
   - 玉米普通鏽病：葉片呈現黃褐色鏽斑

這些視覺差異正是模型學習和識別的關鍵特徵。

---

### 3. 訓練歷史曲線分析

使用雙子圖展示訓練過程中的損失和準確率變化：

![訓練歷史曲線](img/training_history.png)

#### 損失曲線（Loss）

- **訓練損失**（紅色線）：從初始的 2.878 快速下降至 0.140
- **驗證損失**（綠色線）：從初始的 428.41 大幅下降至 0.127
- **最佳 Epoch**：標記驗證損失最低的 epoch 位置（藍色點）
- **關鍵觀察**：
  - 初期驗證損失異常高（428.41），但迅速收斂
  - 訓練過程中兩條曲線趨勢一致，顯示無明顯過擬合
  - 最佳驗證損失出現在後期 epoch，模型持續改善

#### 準確率曲線（Accuracy）

- **訓練準確率**（紅色線）：從 90.21% 穩定上升至 99.92%
- **驗證準確率**（綠色線）：從 7.29% 快速提升至 99.87%
- **最佳 Epoch**：標記驗證準確率最高的 epoch 位置（藍色點）
- **關鍵觀察**：
  - 初始階段驗證準確率極低，但隨訓練快速改善
  - 訓練和驗證準確率曲線高度重合，差距極小（< 0.2%）
  - 後期準確率穩定在 99% 以上，顯示模型收斂良好

**整體訓練特徵**：

- 訓練過程穩定，沒有劇烈波動
- 學習率動態調整策略有效，避免了過早停滯
- 模型在訓練和驗證集上表現一致，泛化能力優秀

---

### 4. 混淆矩陣分析

使用熱圖（Heatmap）展示前 20 個類別的混淆矩陣：

![混淆矩陣](img/confusion_matrix.png)

- **視覺化方式**：使用 seaborn 熱圖，顏色深度表示預測數量
- **對角線分析**：

  - 對角線元素（正確預測）佔絕大多數
  - 大部分類別的對角線值接近或等於該類別的樣本總數
  - 顯示模型對這些類別的識別準確率極高

- **非對角線元素**：

  - 非對角線區域幾乎為空白或極小值
  - 說明類別間混淆極少，模型能夠清晰區分不同類別
  - 即使存在誤分類，數量也極其有限

- **視覺特徵**：
  - 圖表整體呈現清晰的對角線模式
  - 顏色分佈集中，大部分區域呈現深色（正確預測）
  - 證明模型在多類別分類任務中表現優異

**關鍵發現**：

- 模型對主要類別（如番茄、蘋果、柑橘等）的分類非常準確
- 極少數混淆主要出現在相似病害類型之間
- 整體分類矩陣接近理想狀態（完美分類時應為對角矩陣）

---

### 5. 單張圖像預測視覺化

對測試集中的單張圖像進行預測並視覺化結果：

- **顯示內容**：

  - 原始圖像
  - 預測類別名稱
  - 預測信心度（百分比）

- **分析價值**：
  - 直觀展示模型的實際預測效果
  - 驗證模型對真實圖像的識別能力
  - 信心度指標幫助判斷預測的可靠性

**觀察結果**：

- 模型能夠準確識別圖像中的植物病害類型
- 預測信心度通常很高（> 95%），顯示模型對其預測很有把握
- 預測結果與實際標籤高度一致

---

### 6. 性能指標比較

比較訓練集、驗證集和測試集的損失和準確率：

![性能指標比較](img/performance_comparison.png)

**關鍵觀察**：

- 三個資料集的損失值非常接近（0.117-0.121），顯示模型在各資料集上表現一致
- 準確率均達到 99.87% 以上，差異極小（< 0.2%）
- 驗證集和測試集表現接近，證明模型具有良好的泛化能力
- 無明顯過擬合現象（訓練集性能未明顯優於驗證/測試集）

### 7. F1 分數分布

展示代表性類別的 F1 分數分布情況：

![F1分數分布](img/f1_scores_distribution.png)

**觀察結果**：

- 大部分類別的 F1 分數達到 1.00（完美分類）
- 少數類別 F1 分數略低但仍高於 0.96，表現優秀
- 圖表顯示模型對各類別都能達到極高的分類準確率

### 視覺化總結

通過上述視覺化分析，可以得出以下結論：

1. **資料品質**：資料集樣本多樣且品質良好，為模型訓練提供了良好基礎
2. **訓練穩定性**：訓練過程平穩，損失和準確率曲線表現理想，無過擬合跡象
3. **分類準確性**：混淆矩陣顯示模型對絕大多數類別都能準確分類
4. **實用性**：單張圖像預測結果證明模型在實際應用中表現可靠
5. **一致性**：各資料集性能指標高度一致，模型泛化能力優秀

所有視覺化結果都支持模型達到 **99.87%** 測試準確率的評估結論。

---

## 模型優勢

### 1. 高準確率

- 測試準確率達到 **99.87%**，接近完美表現
- 大部分類別達到 100% 的分類準確率

### 2. 優秀的泛化能力

- 訓練集與測試集準確率差距極小（0.12%）
- 驗證集準確率 99.91%，顯示模型具有良好的泛化性

### 3. 穩定的訓練過程

- 使用自定義 Callback 實現動態學習率調整
- 訓練過程穩定，沒有出現過度擬合

### 4. 完整的類別覆蓋

- 成功識別 38 種不同的植物病害類型
- 涵蓋健康與病害狀態的準確分類

---

## 技術細節

### 環境配置

- **TensorFlow 版本**：2.10.0
- **GPU 支援**：是（已配置記憶體動態增長）
- **Python 版本**：3.9

### 關鍵技術

1. **遷移學習**：使用 ImageNet 預訓練的 EfficientNetB3
2. **正則化技術**：
   - L2 正則化（kernel）：0.016
   - L1 正則化（activity & bias）：0.006
   - Dropout：0.45
3. **批次正規化**：momentum=0.99, epsilon=0.001
4. **學習率調度**：基於驗證損失的自適應學習率衰減

---

## 結論

本模型在 PlantVillage 植物病害檢測任務上表現優異：

- ✅ **測試準確率**：99.87%
- ✅ **泛化能力**：優秀（訓練/測試差距僅 0.12%）
- ✅ **類別覆蓋**：38 種類別，大部分達到完美分類
- ✅ **實用性**：模型穩定可靠，適合實際應用

### 適用場景

1. 農業病害自動檢測系統
2. 植物健康監測平台
3. 農業物聯網（IoT）應用
4. 農業諮詢服務工具

### 改進建議

雖然模型表現已經非常優秀，但仍有改進空間：

1. **少數類別優化**：針對 F1 分數略低於 1.00 的類別（如 Corn Cercospora leaf spot）可以進一步調整
2. **資料增強**：可以針對困難樣本進行更針對性的資料增強
3. **集成學習**：可以考慮結合多個模型的預測結果提升穩定性

---

## 方法分析：參考資料與最終方法優缺點

### 參考的四種方法分析

本專案參考了四種不同的植物病害檢測方法，以下是各方法的優缺點：

#### 1. 自定義 CNN 方法（~90% 準確率）

**優點：**

- **架構簡單**：從頭設計，易於理解和修改
- **參數可控**：可根據需求調整網路深度和寬度
- **無依賴性**：不依賴預訓練模型，訓練過程透明
- **資源需求低**：模型規模較小，訓練和推理速度快

**缺點：**

- **準確率較低**：僅達到 ~90%，無法滿足高精度需求
- **需要大量資料**：從頭訓練需要更多樣本才能收斂
- **特徵提取能力有限**：缺乏預訓練知識，特徵學習效率低
- **開發時間長**：需要大量實驗來設計合適的架構

#### 2. MobileNet 遷移學習方法（~96% 準確率）

**優點：**

- **輕量級模型**：參數少，推理速度快，適合移動設備
- **遷移學習優勢**：利用 ImageNet 預訓練權重，提升特徵提取能力
- **使用 segmented 資料**：預處理後的資料可能有助於模型學習
- **部署友好**：模型小，適合邊緣計算和移動應用

**缺點：**

- **準確率仍有提升空間**：96% 雖好但未達最佳
- **需要資料預處理**：segmented 資料需要額外的圖像分割步驟
- **特徵提取能力受限**：MobileNet 為輕量設計，特徵表達能力不如大型模型
- **複雜場景表現一般**：對於細微病害特徵的識別可能不夠精確

#### 3. EfficientNetB3 + Callback 系統（~99.6% 準確率）

**優點：**

- **極高準確率**：達到 99.6%，接近完美表現
- **高效架構**：EfficientNet 在準確率和效率間取得良好平衡
- **動態學習率調整**：Callback 系統能自動優化訓練過程
- **泛化能力強**：預訓練模型帶來優秀的特徵提取能力

**缺點：**

- **模型較大**：EfficientNetB3 參數較多，需要更多計算資源
- **訓練時間長**：相比輕量模型，訓練耗時更長
- **記憶體需求高**：需要較大的 GPU 記憶體
- **超參數敏感**：需要仔細調整 Callback 參數才能達到最佳效果

#### 4. Xception + 資料增強（~99.5% 準確率）

**優點：**

- **高準確率**：99.5% 表現優秀
- **深度可分離卷積**：Xception 架構高效，參數利用率高
- **資料增強策略**：有效提升模型泛化能力
- **特徵提取能力強**：深度網路能學習複雜特徵

**缺點：**

- **計算成本高**：Xception 深度大，訓練和推理較慢
- **記憶體消耗大**：需要大量 GPU 記憶體
- **準確率略低於 EfficientNet**：在相同條件下略遜於 EfficientNetB3
- **架構複雜**：模型結構較複雜，調試和修改較困難

### PlantVillage 資料集優缺點

#### 優點

1. **規模大且多樣**：54,305 張圖片，涵蓋 38 個類別，14 種植物
2. **標註準確**：類別標籤清晰，適合監督學習
3. **圖像品質良好**：256×256 像素，清晰度高，便於模型學習
4. **類別平衡**：大部分類別樣本數相對均衡，避免嚴重不平衡問題
5. **涵蓋範圍廣**：包含健康與病害狀態，多種病害類型（真菌、細菌、病毒）
6. **標準化資料集**：廣泛使用，便於與其他研究比較

#### 缺點

1. **實驗室環境**：圖片多為實驗室條件拍攝，與實際田間環境有差異
2. **光照條件單一**：缺乏多樣化的光照條件，可能影響泛化能力
3. **背景單一**：多為單色背景，缺乏複雜背景場景
4. **類別不平衡**：部分類別樣本數差異較大（如 Orange_Haunglongbing 551 樣本 vs Potato_healthy 15 樣本）
5. **缺乏時序資訊**：僅有單一時刻的圖片，無病害發展過程資料
6. **地域限制**：主要反映特定地區的植物病害，可能不適用於所有地區

### 最終採用方法的優缺點

#### 優點

1. **極高準確率**：99.87% 測試準確率，超越所有參考方法
2. **優秀的泛化能力**：訓練/測試差距僅 0.12%，過擬合風險極低
3. **方法整合**：結合多種最佳實踐，取長補短
   - EfficientNetB3 的高準確率優勢
   - DataFrame 資料管理的靈活性
   - 自定義 Callback 的動態調整能力
   - 完整資料增強策略的泛化提升
4. **訓練穩定性**：自定義 Callback 實現智能學習率調整，訓練過程平穩
5. **正則化完善**：L1/L2 正則化 + Dropout 0.45，有效防止過擬合
6. **類別覆蓋完整**：38 個類別中 31 個達到完美分類（F1=1.00）
7. **實用性強**：模型穩定可靠，適合實際部署

#### 缺點

1. **計算資源需求高**：
   - EfficientNetB3 參數多（約 1100 萬可訓練參數）
   - 需要 GPU 加速，訓練時間長（4 小時 37 分）
   - 記憶體需求較大
2. **模型檔案大**：保存的模型檔案較大，部署時需要考慮儲存空間
3. **推理速度**：相比 MobileNet 等輕量模型，推理速度較慢
4. **超參數複雜**：需要調整多個超參數（學習率、正則化係數、Dropout 率等）
5. **少數類別仍有改進空間**：7 個類別 F1 分數 < 1.00，雖已很高但可進一步優化
6. **資料增強策略固定**：使用固定的增強參數，未針對困難樣本進行個性化增強
7. **缺乏模型集成**：單一模型，未使用集成學習提升穩定性
8. **依賴預訓練模型**：需要 ImageNet 預訓練權重，對網路連接有要求

### 方法選擇的合理性

最終選擇 EfficientNetB3 而非其他模型的原因：

1. **準確率優先**：在植物病害檢測任務中，準確率比速度更重要（錯誤診斷可能導致嚴重後果）
2. **效率平衡**：EfficientNetB3 在準確率和效率間取得最佳平衡，比 Xception 更高效
3. **遷移學習優勢**：ImageNet 預訓練權重提供強大的特徵提取能力
4. **實證支持**：參考方法 3 已證明 EfficientNetB3 可達到 99.6% 準確率
5. **資源可獲得性**：現代 GPU 已能支持 EfficientNetB3 的訓練和推理

### 與其他可能方法的比較

**未選擇 MobileNet 的原因**：

- 準確率差距明顯（96% vs 99.87%），在醫療/農業應用中差距不可接受

**未選擇 Xception 的原因**：

- 準確率略低（99.5% vs 99.87%）
- 計算效率不如 EfficientNetB3
- 記憶體需求更高

**未選擇自定義 CNN 的原因**：

- 準確率差距過大（90% vs 99.87%）
- 開發和調試成本高
- 缺乏預訓練知識，需要更多資料

---

**模型版本**：EfficientNetB3-Plant Village Disease-99.87
